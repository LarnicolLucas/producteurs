import styles from './energie.module.sass'

import {useEffect, useState} from 'react'

import Head from 'next/head'
import palette from '../../components/palette/palette'

import Requete from '../../components/requetes/requetes'
import createList from '../../components/createList/createList'

import Graph from '../../components/graph/graph'


export default function Home() {

  const [listData, setListData] = useState([]);

  const type = 'F4'

  const style= {
    background: palette[0],
    color: palette[2]
  };
 

  useEffect(async ()=>{

    try{
        const res = await fetch(Requete(-1, type, 0, 2021));
        const data = await res.json();
        const newList = createList(data.records);
        setListData(newList);

    } catch(err){
        console.log(err)
    }
  }, []);

  return (
    <>
      <Head>
        <title>Analyse de l'énergie {type}</title>
        <meta name="description" content="Generated by create next app" />
        <link rel="icon" href="/favicon.ico" />
      </Head>

      <section style={style}>

        <article className={styles.graphContainer}>

        <Graph datas={{
          label : `Evolution du nombre des producteur de type ${type} raccordé au réseau`,
          data: listData.data,
          legends: listData.legend,
          color: palette[2]
          }}
          />
          <div></div>

        </article>

      </section>

    </>


  )
}